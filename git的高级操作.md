# Git的高级操作
## Git钩子
和其它版本控制系统一样，Git 能在特定的重要动作发生时触发自定义脚本。 有两组这样的钩子：客户端的和服务器端的。 客户端钩子由诸如提交和合并这样的操作所调用，而服务器端钩子作用于诸如接收被推送的提交这样的联网操作。 你可以随心所欲地运用这些钩子。
**Git hooks**是git在工作流程的特定重要动作发生时触发的自定义脚本。有两组这样的钩子：客户端的和服务端的。客户端钩子由诸如提交和合并这样的操作所调用，而服务端钩子作用与诸如接收被推送的提交这样的联网操作。
### 客户端钩子
客户端钩子分好几种，比较常用的有`pre-commit`, `commit-msg`, `pre-push`和`pre-rebase`.
1. `pre-commit`钩子在键入提交信息前运行。 它用于检查即将提交的快照，例如，检查是否有所遗漏，确保测试运行，以及核查代码。 如果该钩子以非零值退出，Git 将放弃此次提交，不过你可以用 git commit --no-verify 来绕过这个环节。 你可以利用该钩子，来检查代码风格是否一致（运行类似 lint 的程序）、尾随空白字符是否存在（自带的钩子就是这么做的），或新方法的文档是否适当。
2. `commit-msg`钩子接收一个参数，此参数即上文提到的，存有当前提交信息的临时文件的路径。 如果该钩子脚本以非零值退出，Git 将放弃提交，因此，可以用来在提交通过前验证项目状态或提交信息。
3. `pre-push`钩子会在 git push 运行期间，更新了远程引用但尚未传送对象时被调用。它接受远程分支的名字和位置作为参数，同时从标准输入中读取一系列待更新的引用。你可以在推送开始之前，用它验证对引用的更新操作（一个非零的退出码将终止推送过程）。
4. `pre-rebase`钩子会在变基之前运行，已非零退出可以中止变基的过程。你可以使用这个钩子来禁止对那些已经进行过推送的提交变基。Git自带的`pre-rebase`钩子示例就是这么做的。
### 服务端钩子
服务端的钩子相对来说比较少，比较有用的有`pre-receive`和`post receive`。
1. `pre-receive`在处理来自客户端的推送之前运行，如果该钩子已非零值退出，则这次推送失败，所有的推送内容都不会被接收。
2. `post-receive`这个钩子在整改推送结束后运行，经常用来在推送完成后更新其他系统服务或者通知用户。他的用途包括给某个邮件列表发信，通知持续集成的服务器或者是更新问题追踪系统，不过客户端在它结束运行之前将保持连接状态，所以如果你想做其他操作需谨慎使用它，因为它将耗费你很长的一段时间。

## 分支
### 分支是什么？
在git中提交时，会保存一个提交（commit）对象，该对象包含一个指向暂存内容快照（snapshot）的指针，包含本次提交的作者等相关附属信息，包含零个或多个指向该提交对象的父对象指针：首次提交是没有直接祖先的，普通提交有一个祖先，由两个或多个分支合并产生的提交则有多个祖先, 而**分支**就是指向这个提交对象的一个可变指针,分支在多次提交之后就连成了一条线，就像河流一样。
![分支][]
git的分支是一个很方便的功能， 它可以提交我们的开发的效率和灵活度，在git上创建分支非常简单，使用`git branch branchname`就可以创建一个分支，使用`git checkout -b [branchname]`可以创建一个分支并直接切换到该新创建的分支上面去。
为了更加形象地说明，我们假设现在有一个工作目录，里面包含了三个将要被暂存和提交地文件。暂存操作会为每一个文件计算校验和，然后会把当前版本地文件快照保存到git仓库（git使用blob对象来保存它们）最终将校验和加入到缓存区等待提交：
``` bash
git add README test.rb LICENSE
git commit -m 'The initial commit of my project'
```
Git的分支，其实本质上仅仅是指向提交对象的**可变指针**，Git的默认分支名字是*master*。在多次提交操作之后，你其实已经有一个指向最后那个提交对象的*master*分支。 它会在每次的提交操作中**自动向前**移动。

> Git的"master"分支并不是一个特殊分支，它就跟其他分支完全没有区别。

### 分支创建
创建一条分支很简单，使用`git branch`命令就可以了，因为它实际上只是创建了一个可移动的指针，所以这个过程是非常迅速的，比如你要创建一个`testing`分支并切换到这个分支:
``` 
git branch testing 
```
![创建分支](https://git-scm.com/book/en/v2/images/two-branches.png)
你可以简单的使用`git log`命令查看各个分支当前所指的对象.提供这一功能的参数是--decorate。
### 分支切换
要切换到一个已存在的分支，你需要使用 git checkout 命令。 我们现在切换到新创建的 testing 分支去：
```
git checkout testing
```
这样就把HEAD指针指向了testing分支。
![切换分支至testing](https://git-scm.com/book/en/v2/images/head-to-testing.png)
